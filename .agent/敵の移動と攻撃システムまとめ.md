# æ•µã®ç§»å‹•ã¨æ”»æ’ƒã‚·ã‚¹ãƒ†ãƒ  ã¾ã¨ã‚

## ğŸ“‹ æ¦‚è¦
ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç§»å‹•ã‹ã‚‰æ”»æ’ƒã¾ã§ã®ä¸€é€£ã®å‡¦ç†ã«ã¤ã„ã¦ã€é–¢é€£ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨å®Ÿè£…æ‰‹é †ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚

---

## ğŸ¯ ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®æµã‚Œ

```
å¾…æ©Ÿ â†’ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ¤œçŸ¥ â†’ è¿½è·¡ â†’ æ¥è¿‘ â†’ æ”»æ’ƒ â†’ ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ â†’ (ç¹°ã‚Šè¿”ã—)
```

---

## ğŸ“‚ é–¢é€£ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€è¦§

### 1. **Enemystate1.cs** - æ•µAIã®çŠ¶æ…‹ç®¡ç†ã¨ç§»å‹•åˆ¶å¾¡
- **å½¹å‰²**: æ•µã®è¡Œå‹•åˆ¤æ–­ã€ç§»å‹•ã€çŠ¶æ…‹é·ç§»ã‚’ç®¡ç†
- **å ´æ‰€**: `Assets\APP\Script\02_Enemy\Enemystate1.cs`

### 2. **Enemykinsetu1.cs** - æ”»æ’ƒç®¡ç†
- **å½¹å‰²**: æ”»æ’ƒã®ãƒ’ãƒƒãƒˆåˆ¤å®šç®¡ç†ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
- **å ´æ‰€**: `Assets\APP\Script\02_Enemy\Enemykinsetu1.cs`

### 3. **CharaAttack.cs** - æ”»æ’ƒåˆ¤å®šå‡¦ç†
- **å½¹å‰²**: æ­¦å™¨ã®ã‚³ãƒ©ã‚¤ãƒ€ãƒ¼æ¥è§¦æ™‚ã®ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†
- **å ´æ‰€**: `Assets\APP\Script\02_Enemy\CharaAttack.cs`

### 4. **EnemyDamage.cs** - ãƒ€ãƒ¡ãƒ¼ã‚¸å—ä»˜å‡¦ç†
- **å½¹å‰²**: æ•µãŒãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãŸæ™‚ã®å‡¦ç†ã€æ­»äº¡æ™‚ã®å®ç®±ãƒ‰ãƒ­ãƒƒãƒ—
- **å ´æ‰€**: `Assets\APP\Script\02_Enemy\EnemyDamage.cs`

### 5. **CharaDamage.cs** - ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†åŸºåº•ã‚¯ãƒ©ã‚¹
- **å½¹å‰²**: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å…±é€šã®ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†ã¨HPç®¡ç†
- **å ´æ‰€**: `Assets\APP\Script\CharaDamage.cs`

---

## ğŸ”„ çŠ¶æ…‹é·ç§»ã‚·ã‚¹ãƒ†ãƒ  (Enemystate1.cs)

### çŠ¶æ…‹ã®å®šç¾© (EnemyState Enum)

```csharp
public enum EnemyState
{
    Idle = 0,      // å¾…æ©Ÿ
    Chase = 1,     // è¿½è·¡
    Approach = 2,  // æ¥è¿‘(æ”»æ’ƒæº–å‚™)
    Attack = 3,    // æ”»æ’ƒä¸­
    Cooldown = 4   // ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³
}
```

### å„çŠ¶æ…‹ã®è©³ç´°

#### 1. **Idle (å¾…æ©ŸçŠ¶æ…‹)**
- **æ¡ä»¶**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ¤œçŸ¥ç¯„å›²å¤–
- **å‹•ä½œ**: 
  - ç§»å‹•ã—ãªã„
  - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åœæ­¢ (MoveX=0, MoveZ=0)
- **é·ç§»**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ¤œçŸ¥ç¯„å›²å†… (15mä»¥å†…) â†’ **Chase**

#### 2. **Chase (è¿½è·¡çŠ¶æ…‹)**
- **æ¡ä»¶**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ¤œçŸ¥ç¯„å›²å†…ã€æ”»æ’ƒç¯„å›²å¤–
- **å‹•ä½œ**:
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«å‘ã‹ã£ã¦ç§»å‹• (`ChasePlayer()`)
  - ç§»å‹•é€Ÿåº¦: 3m/s (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ–¹å‘ã‚’å‘ã (`FacePlayer()`)
  - ç§»å‹•ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ›´æ–° (Blend Treeä½¿ç”¨)
- **é·ç§»**:
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¿½è·¡ç¯„å›²å¤– (20mä»¥ä¸Š) â†’ **Idle**
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ”»æ’ƒç¯„å›²å†… (2.5mä»¥å†…) ã‹ã¤ ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³å®Œäº† â†’ **Approach**

#### 3. **Approach (æ¥è¿‘/æ”»æ’ƒæº–å‚™çŠ¶æ…‹)**
- **æ¡ä»¶**: æ”»æ’ƒç¯„å›²å†…ã«å…¥ã£ãŸç›´å¾Œ
- **å‹•ä½œ**:
  - ç§»å‹•åœæ­¢
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ–¹ã‚’å‘ã (`FacePlayer()`)
  - æ­£é¢ã‚’å‘ãã¾ã§å¾…æ©Ÿ
- **é·ç§»**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå‰æ–¹30åº¦ä»¥å†… â†’ **Attack**

#### 4. **Attack (æ”»æ’ƒçŠ¶æ…‹)**
- **æ¡ä»¶**: æ”»æ’ƒæº–å‚™å®Œäº†
- **å‹•ä½œ**:
  - æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ (Attack=1f)
  - ç§»å‹•åœæ­¢
  - æ”»æ’ƒã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒãƒ¼è¨­å®š (2ç§’)
  - `isAttacking` ãƒ•ãƒ©ã‚°ã‚’ true ã«è¨­å®š
- **é·ç§»**: å³åº§ã« â†’ **Cooldown**

#### 5. **Cooldown (ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³çŠ¶æ…‹)**
- **æ¡ä»¶**: æ”»æ’ƒå®Ÿè¡Œå¾Œ
- **å‹•ä½œ**:
  - ç§»å‹•åœæ­¢
  - ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒãƒ¼ã®ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³
  - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†ã‚’å¾…ã¤
- **é·ç§»**: ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³å®Œäº†å¾Œ
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ”»æ’ƒç¯„å›²å†… â†’ **Approach**
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ”»æ’ƒç¯„å›²å¤– â†’ **Chase**

---

## ğŸƒ ç§»å‹•å‡¦ç†ã®è©³ç´°

### ChasePlayer() ãƒ¡ã‚½ãƒƒãƒ‰
```csharp
void ChasePlayer()
{
    // 1. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¸ã®æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¨ˆç®—
    Vector3 direction = (player.transform.position - transform.position).normalized;
    direction.y = 0; // Yè»¸æ–¹å‘ã®ç§»å‹•ã‚’ç„¡åŠ¹åŒ–(æ°´å¹³ç§»å‹•ã®ã¿)

    // 2. CharacterControllerã§ç§»å‹•
    if (characterController != null)
    {
        characterController.Move(direction * moveSpeed * Time.deltaTime);
    }
    else
    {
        transform.position += direction * moveSpeed * Time.deltaTime;
    }

    // 3. Blend Treeç”¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›´æ–°
    UpdateMovementAnimation(direction);

    // 4. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ–¹ã‚’å‘ã
    FacePlayer();
}
```

### UpdateMovementAnimation() ãƒ¡ã‚½ãƒƒãƒ‰
```csharp
void UpdateMovementAnimation(Vector3 worldDirection)
{
    // ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã®ç§»å‹•æ–¹å‘ã‚’ãƒ­ãƒ¼ã‚«ãƒ«åº§æ¨™ç³»ã«å¤‰æ›
    Vector3 localDirection = transform.InverseTransformDirection(worldDirection);

    // Blend Treeã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›´æ–°
    // MoveX: å·¦å³ã®ç§»å‹• (-1: å·¦, 0: ãªã—, 1: å³)
    // MoveZ: å‰å¾Œã®ç§»å‹• (-1: å¾Œã‚, 0: ãªã—, 1: å‰)
    animator.SetFloat("MoveX", localDirection.x);
    animator.SetFloat("MoveZ", localDirection.z);
}
```

### FacePlayer() ãƒ¡ã‚½ãƒƒãƒ‰
```csharp
void FacePlayer()
{
    Vector3 direction = (player.transform.position - transform.position).normalized;
    direction.y = 0; // Yè»¸ã¯å›ºå®š(æ°´å¹³å›è»¢ã®ã¿)

    if (direction != Vector3.zero)
    {
        Quaternion targetRotation = Quaternion.LookRotation(direction);
        // ã‚¹ãƒ ãƒ¼ã‚ºã«å›è»¢ (rotationSpeed = 5f)
        transform.rotation = Quaternion.Slerp(transform.rotation, targetRotation, rotationSpeed * Time.deltaTime);
    }
}
```

---

## âš”ï¸ æ”»æ’ƒå‡¦ç†ã®è©³ç´°

### æ”»æ’ƒã®æµã‚Œ

```
1. AttackçŠ¶æ…‹ã«é·ç§»
   â†“
2. Animatorãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ "Attack" ã‚’ 1f ã«è¨­å®š
   â†“
3. æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
   â†“
4. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ "AttackStart" ç™ºç«
   â†“
5. Enemykinsetu1.AttackStart() ç›´æ¥å‘¼ã³å‡ºã—
   â†“
6. ãƒ’ãƒƒãƒˆã‚«ã‚¦ãƒ³ãƒˆè¨­å®š (Hcount = 1)
   â†“
7. æ­¦å™¨ã®ã‚³ãƒ©ã‚¤ãƒ€ãƒ¼ãŒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«æ¥è§¦
   â†“
8. CharaAttack.OnTriggerEnter() å‘¼ã³å‡ºã—
   â†“
9. ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†å®Ÿè¡Œ
   â†“
10. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ "Hit" ç™ºç«
   â†“
11. Enemykinsetu1.Hit() ç›´æ¥å‘¼ã³å‡ºã— (Hcount = 0)
   â†“
12. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ "AttackEnd" ç™ºç«
   â†“
13. Enemykinsetu1.AttackEnd() ç›´æ¥å‘¼ã³å‡ºã— (Attack = 0f)
```

### Enemykinsetu1.cs - æ”»æ’ƒç®¡ç†

```csharp
public class Enemykinsetu1 : MonoBehaviour, ICharaAttack
{
    Animator animator;
    int Hcount;        // æ”»æ’ƒãƒ’ãƒƒãƒˆå›æ•°
    bool Attacktime;   // æ”»æ’ƒä¸­ãƒ•ãƒ©ã‚°

    // ICharaAttackã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Ÿè£…
    public int HitCount()
    {
        return Hcount; // ç¾åœ¨ã®æ®‹ã‚Šãƒ’ãƒƒãƒˆæ•°ã‚’è¿”ã™
    }

    public void HitCountdown()
    {
        if(Hcount > 0)
        {
            --Hcount; // ãƒ€ãƒ¡ãƒ¼ã‚¸ãŒå…¥ã‚‹ã“ã¨ãŒç¢ºå®šã—ãŸéš›ã«æ®‹ã‚Šãƒ’ãƒƒãƒˆæ•°ã‚’æ¸›ã‚‰ã™
        }
    }

    public bool Attacktimeinspection()
    {
        return Attacktime; // æ”»æ’ƒä¸­ã‹æ”»æ’ƒä¸­ã§ãªã„ã‹ã‚’è¿”ã™
    }

    // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã‹ã‚‰å‘¼ã°ã‚Œã‚‹
    public void AttackStart()
    {
        Hcount = 1;           // ãƒ’ãƒƒãƒˆå¯èƒ½å›æ•°ã‚’1ã«è¨­å®š
        Attacktime = true;    // æ”»æ’ƒä¸­ãƒ•ãƒ©ã‚°ã‚’ON
    }

    public void Hit()
    {
        Hcount = 0;           // ãƒ’ãƒƒãƒˆå›æ•°ã‚’ãƒªã‚»ãƒƒãƒˆ
        Attacktime = false;   // æ”»æ’ƒä¸­ãƒ•ãƒ©ã‚°ã‚’OFF
    }

    public void AttackEnd()
    {
        animator.SetFloat("Attack", 0f); // Attackãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’0ã«ã™ã‚‹
    }
}
```

### CharaAttack.cs - ãƒ€ãƒ¡ãƒ¼ã‚¸åˆ¤å®š

```csharp
public class CharaAttack : MonoBehaviour
{
    [SerializeField] private Charadata charaData;
    [SerializeField] GameObject AttackChara; // å‰£ã‚’æŒã£ã¦ã„ã‚‹ã‚²ãƒ¼ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ(è¦ª)

    int HHcount;
    int ATK;
    ICharaAttack Hcount;

    void Start()
    {
        var CharaStatus = charaData.GetCharaStatus();
        int ATK = CharaStatus.ATK;
        
        // ICharaAttackã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æŒã¤ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å–å¾—
        Hcount = AttackChara.GetComponent<ICharaAttack>();
    }

    // å‰£ãŒã‚²ãƒ¼ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä¾µå…¥ã—ãŸç¬é–“ã«å‘¼ã³å‡ºã—
    void OnTriggerEnter(Collider other)
    {
        // æ®‹ã‚Šãƒ’ãƒƒãƒˆæ•°ã‚’å–å¾—
        HHcount = Hcount.HitCount();

        // HHcountãŒ0ä»¥ä¸‹ãªã‚‰ã‚‚ã†æ—¢ã«ãƒ’ãƒƒãƒˆã—ã¦ã„ã‚‹
        if (HHcount <= 0)
        {
            return;
        }

        if (other.tag == "Player")
        {
            // IDamageableã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å–å¾—
            IDamageable damageable = other.GetComponent<IDamageable>();

            if (damageable != null)
            {
                // ãƒ€ãƒ¡ãƒ¼ã‚¸ãŒå…¥ã‚‹ã®ãŒç¢ºå®šã—ãŸã®ã§ãƒ’ãƒƒãƒˆæ•°-1
                Hcount.HitCountdown();

                // ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™
                damageable.Damage(ATK);
            }
        }
    }
}
```

---

## ğŸ¬ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 

### ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã®è¨­å®š

æ•µå°‚ç”¨ã®AnimationControllerã‚’ä½œæˆã—ã€æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ä»¥ä¸‹ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›´æ¥è¨­å®šã—ã¾ã™ã€‚

æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ä»¥ä¸‹ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š:

1. **AttackStart** - æ”»æ’ƒé–‹å§‹æ™‚ (å‰£ã‚’æŒ¯ã‚Šå§‹ã‚ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°)
   - å‘¼ã³å‡ºã™ãƒ¡ã‚½ãƒƒãƒ‰: `Enemykinsetu1.AttackStart()`
   - ã‚¿ã‚¤ãƒŸãƒ³ã‚°: å‰£ã‚’æŒ¯ã‚Šå§‹ã‚ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ 

2. **Hit** - ãƒ’ãƒƒãƒˆåˆ¤å®šçµ‚äº†æ™‚ (å‰£ã‚’æŒ¯ã‚Šçµ‚ã‚ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°)
   - å‘¼ã³å‡ºã™ãƒ¡ã‚½ãƒƒãƒ‰: `Enemykinsetu1.Hit()`
   - ã‚¿ã‚¤ãƒŸãƒ³ã‚°: å‰£ã‚’æŒ¯ã‚Šçµ‚ã‚ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ 

3. **AttackEnd** - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†æ™‚
   - å‘¼ã³å‡ºã™ãƒ¡ã‚½ãƒƒãƒ‰: `Enemykinsetu1.AttackEnd()`
   - ã‚¿ã‚¤ãƒŸãƒ³ã‚°: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æœ€çµ‚ãƒ•ãƒ¬ãƒ¼ãƒ 

### ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã®è¿½åŠ æ–¹æ³•

1. Unityã‚¨ãƒ‡ã‚£ã‚¿ã§æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¯ãƒªãƒƒãƒ—ã‚’é¸æŠ
2. Animationã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ã
3. ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸã„ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’é¸æŠ
4. ã‚¤ãƒ™ãƒ³ãƒˆãƒœã‚¿ãƒ³(æ——ã®ã‚¢ã‚¤ã‚³ãƒ³)ã‚’ã‚¯ãƒªãƒƒã‚¯
5. Functionåã«ä¸Šè¨˜ã®ãƒ¡ã‚½ãƒƒãƒ‰åã‚’å…¥åŠ›
6. æ•µã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«`Enemykinsetu1`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚¢ã‚¿ãƒƒãƒã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª



---

## ğŸ’¥ ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ 

### CharaDamage.cs - åŸºåº•ã‚¯ãƒ©ã‚¹

```csharp
public class CharaDamage : MonoBehaviour, IDamageable
{
    [SerializeField] protected Charadata charadata;
    [SerializeField] protected Slider Slider;
    [SerializeField] protected DamageTextManager damageTextManager;

    protected int HP;
    protected int MAXHP;
    protected int DEF;

    public virtual void Damage(int value)
    {
        var Status = charadata.GetCharaStatus();
        var Raw = charadata.GetRawStatus();
        
        if (charadata != null)
        {
            // ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—: æ”»æ’ƒåŠ› - é˜²å¾¡åŠ›
            int actualDamage = value - Status.DEF;
            HP -= actualDamage;
            
            // ãƒ€ãƒ¡ãƒ¼ã‚¸ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            OnDamageReceived(actualDamage);
            
            // HPã‚²ãƒ¼ã‚¸ã®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’æ›´æ–°
            Slider.value = (float)HP / (float)Raw.MAXHP;
        }
        
        // HPãŒ0ä»¥ä¸‹ã«ãªã£ãŸã‚‰æ­»äº¡å‡¦ç†
        if (HP <= 0)
        {
            Death();
        }
    }

    protected virtual void OnDamageReceived(int damage)
    {
        Debug.Log($"[CharaDamage] å—ã‘ãŸãƒ€ãƒ¡ãƒ¼ã‚¸: {damage}");
        
        // ãƒ€ãƒ¡ãƒ¼ã‚¸ãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤º
        if (damageTextManager != null)
        {
            Vector3 damageTextPosition = transform.position + Vector3.up * 2f;
            damageTextManager.ShowDamage(damage, damageTextPosition);
        }
    }

    protected virtual void Death()
    {
        Destroy(gameObject);
    }
}
```

### EnemyDamage.cs - æ•µå°‚ç”¨ã®æ‹¡å¼µ

```csharp
public class EnemyDamage : CharaDamage
{
    [SerializeField] private GameObject treasureBoxPrefab;
    [SerializeField] private Transform dropPoint;

    protected override void Death()
    {
        Debug.Log("æ•µæ­»äº¡");
        SpawnTreasure();  // å®ç®±ã‚’ãƒ‰ãƒ­ãƒƒãƒ—
        base.Death();     // åŸºåº•ã‚¯ãƒ©ã‚¹ã®æ­»äº¡å‡¦ç†ã‚’å‘¼ã¶
    }

    private void SpawnTreasure()
    {
        Vector3 spawnPos = dropPoint != null ? dropPoint.position : transform.position;
        Instantiate(treasureBoxPrefab, spawnPos, Quaternion.identity);
        Debug.Log("å®ç®±ç”Ÿæˆ");
    }
}
```

---

## ğŸ”§ å®Ÿè£…æ‰‹é †

### 1. æ•µã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### å¿…è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **Animator** - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡
- **CharacterController** - ç§»å‹•åˆ¶å¾¡
- **Enemystate1** - AIåˆ¶å¾¡
- **Enemykinsetu1** - æ”»æ’ƒç®¡ç†
- **EnemyDamage** - ãƒ€ãƒ¡ãƒ¼ã‚¸å—ä»˜
- **Charadata (ScriptableObject)** - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ‡ãƒ¼ã‚¿

#### ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼è¨­å®š (Enemystate1)
```
Detection Range: 15f    // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ¤œçŸ¥ç¯„å›²
Chase Range: 20f        // è¿½è·¡ç¯„å›²
Attack Range: 2.5f      // æ”»æ’ƒç¯„å›²
Move Speed: 3f          // ç§»å‹•é€Ÿåº¦
Rotation Speed: 5f      // å›è»¢é€Ÿåº¦
Attack Cooldown: 2f     // æ”»æ’ƒã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æ™‚é–“
Player: (Playerã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¨­å®š)
Charadata: (ScriptableObjectã‚’è¨­å®š)
```

### 2. æ­¦å™¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### æ­¦å™¨(å‰£)ã®æ§‹æˆ
- **è¦ªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**: æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
- **å­ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**: æ­¦å™¨ (Sword)
  - **Collider** (Trigger ON)
  - **CharaAttack.cs**

#### ã‚¤ãƒ³ã‚¹ãƒšã‚¯ã‚¿ãƒ¼è¨­å®š (CharaAttack)
```
Chara Data: (æ•µã®ScriptableObjectã‚’è¨­å®š)
Attack Chara: (è¦ªã®æ•µã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¨­å®š)
```

### 3. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®š

#### Animatorãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- **Attack** (Float) - æ”»æ’ƒãƒˆãƒªã‚¬ãƒ¼ (0: å¾…æ©Ÿ, 1: æ”»æ’ƒ)
- **MoveX** (Float) - å·¦å³ç§»å‹• (-1 ~ 1)
- **MoveZ** (Float) - å‰å¾Œç§»å‹• (-1 ~ 1)

#### Blend Treeè¨­å®š
- **2D Freeform Directional**
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: MoveX, MoveZ
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³:
  - Idle (0, 0)
  - Walk Forward (0, 1)
  - Walk Backward (0, -1)
  - Walk Left (-1, 0)
  - Walk Right (1, 0)

#### ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
æ”»æ’ƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ä»¥ä¸‹ã‚’è¿½åŠ :
1. **AttackStart** - å‰£ã‚’æŒ¯ã‚Šå§‹ã‚ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ 
2. **Hit** - å‰£ã‚’æŒ¯ã‚Šçµ‚ã‚ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ 
3. **AttackEnd** - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æœ€çµ‚ãƒ•ãƒ¬ãƒ¼ãƒ 

### 4. ã‚¿ã‚°ã¨ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è¨­å®š

- **æ•µã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**: ã‚¿ã‚° "Enemy"
- **ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**: ã‚¿ã‚° "Player"
- **æ­¦å™¨ã®Collider**: Is Trigger = ON

---

## ğŸ› ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½

### Gizmosè¡¨ç¤º

Enemystate1.csã«ã¯ã€Sceneãƒ“ãƒ¥ãƒ¼ã§ç¯„å›²ã‚’è¦–è¦šåŒ–ã™ã‚‹Gizmosæ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

```csharp
void OnDrawGizmosSelected()
{
    // æ¤œçŸ¥ç¯„å›²(é»„è‰²)
    Gizmos.color = Color.yellow;
    Gizmos.DrawWireSphere(transform.position, detectionRange);

    // è¿½è·¡ç¯„å›²(ã‚ªãƒ¬ãƒ³ã‚¸)
    Gizmos.color = new Color(1f, 0.5f, 0f);
    Gizmos.DrawWireSphere(transform.position, chaseRange);

    // æ”»æ’ƒç¯„å›²(èµ¤)
    Gizmos.color = Color.red;
    Gizmos.DrawWireSphere(transform.position, attackRange);

    // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¸ã®ç·š(ã‚·ã‚¢ãƒ³)
    if (player != null)
    {
        Gizmos.color = Color.cyan;
        Gizmos.DrawLine(transform.position, player.transform.position);
    }
}
```

### ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°

å„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«Debug.LogãŒå®Ÿè£…ã•ã‚Œã¦ãŠã‚Šã€ä»¥ä¸‹ã®æƒ…å ±ã‚’ç¢ºèªã§ãã¾ã™:
- ãƒ€ãƒ¡ãƒ¼ã‚¸é‡
- æ•µã®æ­»äº¡
- å®ç®±ç”Ÿæˆ

---

## ğŸ“Š ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ã‚¬ã‚¤ãƒ‰

### ç§»å‹•é€Ÿåº¦ã®èª¿æ•´
- **Move Speed**: 3f ãŒæ¨™æº–
  - é€Ÿãã—ãŸã„å ´åˆ: 4-5f
  - é…ãã—ãŸã„å ´åˆ: 1-2f

### æ”»æ’ƒé »åº¦ã®èª¿æ•´
- **Attack Cooldown**: 2f ãŒæ¨™æº–
  - é »ç¹ã«æ”»æ’ƒ: 1-1.5f
  - æ§ãˆã‚ã«æ”»æ’ƒ: 3-4f

### æ¤œçŸ¥ç¯„å›²ã®èª¿æ•´
- **Detection Range**: 15f (ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¦‹ã¤ã‘ã‚‹è·é›¢)
- **Chase Range**: 20f (è¿½è·¡ã‚’ç¶šã‘ã‚‹è·é›¢)
- **Attack Range**: 2.5f (æ”»æ’ƒã‚’é–‹å§‹ã™ã‚‹è·é›¢)

**æ¨å¥¨è¨­å®š**: Chase Range > Detection Range > Attack Range

### å›è»¢é€Ÿåº¦ã®èª¿æ•´
- **Rotation Speed**: 5f ãŒæ¨™æº–
  - ç´ æ—©ãå‘ãã‚’å¤‰ãˆã‚‹: 7-10f
  - ã‚†ã£ãã‚Šå‘ãã‚’å¤‰ãˆã‚‹: 2-3f

---

## ğŸ”— ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

### ICharaAttack
æ”»æ’ƒç®¡ç†ç”¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (å®šç¾©å ´æ‰€ã¯ä¸æ˜ã€ãŠãã‚‰ãåˆ¥ãƒ•ã‚¡ã‚¤ãƒ«)

```csharp
public interface ICharaAttack
{
    int HitCount();        // æ®‹ã‚Šãƒ’ãƒƒãƒˆæ•°ã‚’è¿”ã™
    void HitCountdown();   // ãƒ’ãƒƒãƒˆæ•°ã‚’æ¸›ã‚‰ã™
}
```

### IDamageable
ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ã‚‰ã‚Œã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```csharp
public interface IDamageable
{
    void Damage(int value); // ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ã‚‹
}
```

### IEnemy
æ•µAIç”¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```csharp
public interface IEnemy
{
    int EnemyAIaction(); // AIè¡Œå‹•ã‚’å®Ÿè¡Œã—ã€ç¾åœ¨ã®çŠ¶æ…‹ã‚’è¿”ã™
}
```

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

å®Ÿè£…æ™‚ã«ç¢ºèªã™ã¹ãé …ç›®:

- [ ] æ•µã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¿…è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå…¨ã¦ä»˜ã„ã¦ã„ã‚‹
- [ ] Animatorãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] æ­¦å™¨ã«Collider (Trigger ON) ã¨CharaAttack.csãŒä»˜ã„ã¦ã„ã‚‹
- [ ] ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ (AttackStart, Hit, AttackEnd)
- [ ] ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãŒ`Enemykinsetu1`ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç›´æ¥å‘¼ã³å‡ºã™ã‚ˆã†ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¿ã‚°è¨­å®šãŒæ­£ã—ã„ (Enemy, Player)
- [ ] Charadata (ScriptableObject) ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå‚ç…§ã•ã‚Œã¦ã„ã‚‹
- [ ] HPã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] DamageTextManagerãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

---

## ğŸ“ ã¾ã¨ã‚

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®ç‰¹å¾´ã‚’æŒã£ã¦ã„ã¾ã™:

1. **çŠ¶æ…‹ãƒ™ãƒ¼ã‚¹ã®AI**: æ˜ç¢ºãªçŠ¶æ…‹é·ç§»ã§æ•µã®è¡Œå‹•ã‚’ç®¡ç†
2. **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é€£å‹•**: Blend Treeã§æ»‘ã‚‰ã‹ãªç§»å‹•ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
3. **ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•**: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§æ”»æ’ƒã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’åˆ¶å¾¡
4. **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ**: æ‹¡å¼µæ€§ã®é«˜ã„è¨­è¨ˆ
5. **ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½**: Gizmosã§ç¯„å›²ã‚’è¦–è¦šåŒ–
6. **ç¶™æ‰¿ã«ã‚ˆã‚‹æ‹¡å¼µ**: CharaDamageã‚’ç¶™æ‰¿ã—ã¦EnemyDamageã‚’å®Ÿè£…

ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã‚Šã€æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®è¿½åŠ ã‚„è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å¤‰æ›´ãŒå®¹æ˜“ã«ãªã£ã¦ã„ã¾ã™ã€‚
